# System Overview - –û–±–∑–æ—Ä –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã

> –õ–∏—Å—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –æ–¥—É–≤–∞–Ω—á–∏–∫–∞ - –æ–±—â–∏–π –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã MAGRAY CLI

[[_Architecture Hub - –¶–µ–Ω—Ç—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏]] ‚Üí System Overview

## üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ MAGRAY?

MAGRAY CLI - —ç—Ç–æ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π AI –∞–≥–µ–Ω—Ç –Ω–∞ Rust —Å —Ç—Ä—ë—Ö—Å–ª–æ–π–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–∞–º—è—Ç–∏ –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º. **–°—Ç–∞—Ç—É—Å: 95% production ready** —Å HNSW –∏–Ω–¥–µ–∫—Å–∞–º–∏, ONNX –º–æ–¥–µ–ª—è–º–∏ –∏ GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º.

```mermaid
mindmap
  root((MAGRAY CLI))
    Core Features
      Vector Search(<5ms)
      3-Layer Memory
        Interact(24h)
        Insights(90d)
        Assets(‚àû)
      GPU Acceleration
        CUDA Support
        Auto Fallback
      Single Binary(16MB)
    
    Architecture
      8 Rust Crates
        cli
        memory
        ai
        llm
        router
        tools
        todo
        common
      HNSW Algorithm
      ONNX Models
        Qwen3(1024D)
        BGE-M3(1024D)
        Reranker
    
    Capabilities
      Multi-LLM Support
        OpenAI
        Anthropic
        Local Models
      Tool Execution
        File Ops
        Git Ops
        Web Ops
        Shell Ops
      Smart Routing
        Intent Analysis
        Task Planning
        DAG Execution
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –æ–±–∑–æ—Ä

MAGRAY CLI - —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 8 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö Rust crates, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

```mermaid
graph TB
    subgraph "User Interface"
        CLI[CLI Layer]
        API[REST API*]
    end
    
    subgraph "Core Logic"
        UA[UnifiedAgent]
        Router[Smart Router]
        LLM[LLM Client]
        Tools[Tool Registry]
    end
    
    subgraph "Data Layer"
        Memory[Memory Service]
        VS[Vector Store]
        Cache[Embedding Cache]
    end
    
    subgraph "AI/ML Layer"
        Embed[Embedding Service]
        GPU[GPU Pipeline]
        Rerank[Reranker]
    end
    
    CLI --> UA
    API -.-> UA
    UA --> Router
    Router --> LLM
    Router --> Tools
    LLM --> Memory
    Tools --> Memory
    Memory --> VS
    Memory --> Cache
    Memory --> Embed
    Embed --> GPU
    Embed --> Rerank
```

## üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. CLI Layer
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞

### 2. UnifiedAgent
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∑–∞–ø—Ä–æ—Å–∞
- Error handling –∏ retry –ª–æ–≥–∏–∫–∞

### 3. Memory System
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- 3-—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Interact ‚Üí Insights ‚Üí Assets)
- –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ HNSW
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏

### 4. AI Pipeline
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –û–±—Ä–∞–±–æ—Ç–∫–∞ AI/ML
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings (BGE-M3)
- GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å fallback –Ω–∞ CPU
- Reranking —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –¢–∏–ø–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **CLI** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É
2. **UnifiedAgent** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç intent
3. **Router** –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
4. **LLM/Tools** –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞—á—É
5. **Memory** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç
6. **CLI** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ü–æ—Ç–æ–∫ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

1. **Query** ‚Üí —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
2. **Embedding Service** ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–∞
3. **Vector Store** ‚Üí HNSW –ø–æ–∏—Å–∫
4. **Reranker** ‚Üí —É–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. **Results** ‚Üí –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ crates —Å —á—ë—Ç–∫–∏–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–º–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Zero-copy –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- SIMD –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Async/await –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π

### 3. –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- Graceful degradation –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å exponential backoff
- Health monitoring –∏ self-healing

### 4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ sharding
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —á–µ—Ä–µ–∑ GPU –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –û—Ç embedded –¥–æ cloud deployments

## üìä –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------|----------|--------|----------|
| Production Ready | 95% | üü¢ | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É |
| Binary Size | ~16MB | üü¢ | Release build |
| Startup Time | 150ms | üü° | Cold start (—Ü–µ–ª—å: 100ms) |
| Vector Search | <5ms | üü¢ | HNSW O(log n) –ø–æ–∏—Å–∫ |
| Test Coverage | 35.4% | üî¥ | –¢–µ–∫—É—â–µ–µ (—Ü–µ–ª—å: 80%) |
| GPU Support | –ì–æ—Ç–æ–≤–æ | üü¢ | CUDA + –∞–≤—Ç–æ—Ñallback |

## üè∑Ô∏è –¢–µ–≥–∏

#architecture #overview #system-design #leaf

---
[[_Architecture Hub - –¶–µ–Ω—Ç—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏|‚Üê –ö —Ü–µ–Ω—Ç—Ä—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –æ–¥—É–≤–∞–Ω—á–∏–∫–∞]]