## –ö–†–ò–¢–ï–†–ò–ò –ü–†–ò–Å–ú–ö–ò
- –ü—Ä–æ–≤–µ—Ä–µ–Ω –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ `docs/ARCHITECTURE_PLAN_ADVANCED.md` –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞–º.
- –í—ã—è–≤–ª–µ–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è (OK/Partial/Missing) —Å —Ç–æ—á–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —Ñ–∞–π–ª—ã/—É—á–∞—Å—Ç–∫–∏ –∏ —Ä–∏—Å–∫–∞–º–∏.
- –û–ø–∏—Å–∞–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–µ/–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏, —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, —Å–∫—Ä—ã—Ç–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å.
- –î–∞–Ω—ã –ø—Ä–∏—Ü–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (fix-–ø–ª–∞–Ω) —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –∏ –æ—Ü–µ–Ω–∫–æ–π —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç.
- –°–æ—Ö—Ä–∞–Ω—ë–Ω –æ—Ç—á—ë—Ç –≤ –≤–∏–¥–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞, –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.

## –ü–õ–ê–ù (–∫—Ä–∞—Ç–∫–∏–π)
- –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è –ø–æ–¥—Å–∏—Å—Ç–µ–º ‚Üí –∫–∞—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–ª–∞–Ω.
- –ì–ª—É–±–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (policy/sandbox/MCP/–ø–ª–∞–≥–∏–Ω—ã), –ø–∞–º—è—Ç–∏ (ANN+BM25+rerank), –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏, –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏, UX dry‚Äërun/–¥–∏—Ñ—Ñ–æ–≤.
- –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π/–æ—à–∏–±–æ–∫ ‚Üí —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏/–º–∏–≥—Ä–∞—Ü–∏–∏.
- –ú–∏–Ω–∏‚ÄëADR –æ —Ç–µ–∫—É—â–µ–º —Å—Ç–∞—Ç—É—Å–µ –∏ –±–ª–∏–∂–∞–π—à–∏—Ö —à–∞–≥–∞—Ö.

## –ê–£–î–ò–¢ –ü–†–û–ï–ö–¢–ê (—Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ)

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º—É –ø–ª–∞–Ω—É (–ø–æ —Ä–∞–∑–¥–µ–ª–∞–º)
- EventBus / –°–æ–±—ã—Ç–∏–π–Ω–∞—è —à–∏–Ω–∞ ‚Äî OK
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: `crates/common/src/event_bus.rs`, –≥–ª–æ–±–∞–ª—å–Ω—ã–π JSON‚Äëbus: `crates/common/src/events.rs`.
  - –¢–æ–ø–∏–∫–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –ø–ª–∞–Ω–æ–º: `intent`, `plan`, `tool.invoked`, `fs.diff`, `memory.upsert`, `memory.search`, `policy.block`, `job.progress`, `llm.tokens`, `error`, `health` (—Å–º. `crates/common/src/topics.rs`).
  - –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å: –º–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä (`start_tool_metrics_aggregator`).

- Policy Engine / –ü–æ–ª–∏—Ç–∏–∫–∏ ‚Äî PARTIAL
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: `crates/common/src/policy.rs` + –æ–±–≤—è–∑–∫–∞ –≤ CLI `crates/cli/src/commands/tools.rs`.
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `Allow/Deny/Ask`, `when_contains_args`, merge default+file+env.
  - –ü—Ä–µ–¥—á–µ–∫ –ø–æ sandbox –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º: –µ—Å—Ç—å (`precheck_permissions`), –Ω–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∑–∞–¥–∞–Ω `spec.permissions`.
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª–∏—Ç–∏–∫–∞ ¬´deny shell_exec¬ª, –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî allow. –≠—Ç–æ —Å–º—è–≥—á–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤/–ø–ª–∞–≥–∏–Ω—ã ‚Äî PARTIAL
  - –†–µ–µ—Å—Ç—Ä –∏ —Ç–∏–ø—ã: `crates/tools/src/lib.rs` (Tool, ToolSpec, ToolRegistry), —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: `tools/registry`, `tools/execution`, `tools/plugins`.
  - –ü–ª–∞–≥–∏–Ω—ã: –∑–∞—è–≤–ª–µ–Ω—ã WASM + –≤–Ω–µ—à–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã. WASM‚Äë—Ä–∞–Ω—Ç–∞–π–º —Å–µ–π—á–∞—Å –∏–º–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π (–Ω–µ wasmtime/WASI), –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ø–µ—Å–æ—á–Ω–∏—Ü—ã/–≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞. –í–Ω–µ—à–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî –µ—Å—Ç—å –±–∞–∑–æ–≤–∞—è ¬´–ø–µ—Å–æ—á–Ω–∏—Ü–∞¬ª –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∏–∑–æ–ª—è—Ü–∏—è = User (–Ω–µ—Ç chroot/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/seccomp). –ü–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

- MCP (Model Context Protocol) ‚Äî PARTIAL
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω ¬´stdio proxy¬ª (`crates/tools/src/mcp.rs`), JSON-–∑–∞–ø—Ä–æ—Å/–æ—Ç–≤–µ—Ç, —Ç–∞–π–º–∞—É—Ç 30—Å.
  - –ù–µ—Ç discovery/–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏/—Å—Ç—Ä–∏–º–∏–Ω–≥–∞/—Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–π; –Ω–µ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π/–ø–æ–ª–∏—Ç–∏–∫ –Ω–∞ MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã; –Ω–µ—Ç allowlist —Å–µ—Ä–≤–µ—Ä–æ–≤.

- –ü–∞–º—è—Ç—å / –ò–Ω–¥–µ–∫—Å—ã / RAG ‚Äî PARTIAL
  - ANN/HNSW: –µ—Å—Ç—å –º–æ–¥—É–ª—å–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø–æ–∏—Å–∫–∞ (`crates/memory/src/orchestration/search_coordinator.rs`), –º–µ—Ç—Ä–∏–∫–∏/–ª–∏–º–∏—Ç—ã/—Ä–µ—Ç—Ä–∞–∏/CB, —Ü–µ–ª–µ–≤—ã–µ p95: <100ms –¥–ª—è –ø–æ–∏—Å–∫–∞.
  - BM25/Tantivy: –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ `tantivy` (`keyword_index/tantivy_index.rs`), –Ω–æ –≤ –ø—Ä–æ–¥‚Äë–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è in‚Äëmemory BM25 (`keyword_index/mod.rs`). –¢.–µ. Tantivy —Å–µ–π—á–∞—Å –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω.
  - Reranker Qwen3 0.6B: –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –ª–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π fallback –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–º ORT.
  - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –æ—Å–Ω–æ–≤–Ω–∞—è ¬´simple engine¬ª –ø–∏—à–µ—Ç JSONL (`magray_memory.jsonl`), SQLite –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–ª–æ–π ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç; sled –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º/–∫—ç—à–∞ (–ø—Ä–∏ —Ñ–∏—á–∞—Ö).

- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (Planner/Executor/Critic/Scheduler) ‚Äî PARTIAL
  - CLI `smart`: –ø—Ä–æ—Å—Ç–æ–π Planner/Executor, –±–µ–∑ Critic/Scheduler.
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`crates/cli/src/orchestrator/tool_orchestrator.rs`) —Å enhanced tool system –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ ‚Äî –µ—Å—Ç—å, –Ω–æ –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–∫—Ç–æ—Ä–æ–≤.

- –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å / –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî OK/PARTIAL
  - Structured logging, JSON layer, –º–∞–∫—Ä–æ—Å—ã –∏ —Ç–∞–π–º–µ—Ä—ã (`crates/common/src/structured_logging.rs`). –í CLI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á—ë–Ω —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥, JSON ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.
  - Health‚Äëchecks/—Å—Ç–∞—Ç—É—Å—ã/–ø–µ—Ä—Ñ.–º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç.

- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å / –ü–µ—Å–æ—á–Ω–∏—Ü–∞ ‚Äî PARTIAL
  - FS/NET/Shell sandbox –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ env+—Ñ–∞–π–ª (`crates/common/src/sandbox_config.rs`).
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã FILE/WEB —É–≤–∞–∂–∞—é—Ç –ø–µ—Å–æ—á–Ω–∏—Ü—É (allowlist, roots). `shell_exec` –∑–∞—â–∏—â—ë–Ω –ø–æ–ª–∏—Ç–∏–∫–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –ø—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –º–∞–ª–æ (—Å–º. –Ω–∏–∂–µ).
  - –ù–µ—Ç —Å–∫–∞–Ω–µ—Ä–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤/PII, –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–µ–π –ø–ª–∞–≥–∏–Ω–æ–≤/–º–æ–¥–µ–ª–µ–π.

- LLM‚Äë–æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ‚Äî OK/PARTIAL
  - –°—Ç–æ–∏–º–æ—Å—Ç–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä/–ø–æ–¥–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (`crates/llm/src/cost_optimizer.rs`) –µ—Å—Ç—å; —Ç–æ–∫–µ–Ω‚Äë–±—é–¥–∂–µ—Ç—ã/—Å–ø–µ–∫—É–ª—è—Ç–∏–≤–Ω–æ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

- TUI/CLI UX (–ø–ª–∞–Ω/–¥–∏—Ñ—Ñ/—Ç–∞–π–º–ª–∞–π–Ω) ‚Äî PARTIAL
  - –ï—Å—Ç—å –¥–∏—Ñ—Ñ‚Äë—Å–æ–±—ã—Ç–∏—è `fs.diff`, –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä/dry‚Äërun —É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ç–∞–π–º–ª–∞–π–Ω‚Äë—Ç–µ—Å—Ç—ã; –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è TUI ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

- DSL —Ä–µ—Ü–µ–ø—Ç–æ–≤/flows ‚Äî MISSING
  - YAML/DSL —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Å—Ö–µ–º –Ω–µ—Ç (–µ—Å—Ç—å –ª–∏—à—å YAML‚Äë–ø–∞—Ä—Å–∏–Ω–≥ –¥–ª—è DI‚Äë–∫–æ–Ω—Ñ–∏–≥–æ–≤ –ø–∞–º—è—Ç–∏).

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, —Ä–∏—Å–∫–∏ –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

1) MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–±—Ö–æ–¥—è—Ç –ø–µ—Å–æ—á–Ω–∏—Ü—É/–ø–æ–ª–∏—Ç–∏–∫—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (High)
- –°–∏–º–ø—Ç–æ–º: `mcp.rs` —Å–æ–∑–¥–∞—ë—Ç `ToolSpec` –±–µ–∑ `permissions`; CLI –ø—Ä–µ–¥—á–µ–∫ –ø–æ –ø–µ—Å–æ—á–Ω–∏—Ü–µ (`precheck_permissions`) —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `spec.permissions`. –î–ª—è MCP ‚Äî –Ω–µ—Ç.
- –†–∏—Å–∫: —É–¥–∞–ª—ë–Ω–Ω—ã–π MCP‚Äë—Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã/–∞—Ä–≥—É–º–µ–Ω—Ç—ã –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π FS/NET/Shell —É—Ä–æ–≤–Ω—è MAGRAY (–∫—Ä–æ–º–µ —è–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª Policy –ø–æ –∏–º–µ–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞).
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ MCP –º–∞–ø–ø–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–º–∏–Ω–∏–º—É–º net=none/allowlist), —Ç—Ä–µ–±–æ–≤–∞—Ç—å —è–≤–Ω—ã–π allowlist —Å–µ—Ä–≤–µ—Ä–æ–≤/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤; –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `Ask`.

2) WASM –ø–ª–∞–≥–∏–Ω—ã –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–Ω—Ç–∞–π–º–∞/–∏–∑–æ–ª—è—Ü–∏–∏ (High)
- –°–∏–º–ø—Ç–æ–º: `plugins/wasm_plugin.rs` ‚Äî ¬´—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º¬ª, –±–µ–∑ wasmtime/WASI, –±–µ–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –ø–∞–º—è—Ç–∏/—Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ¬ª ‚Äî —ç–º—É–ª—è—Ü–∏—è.
- –†–∏—Å–∫: –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö wasm‚Äë–ø–ª–∞–≥–∏–Ω–æ–≤.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ wasmtime —Å —Ä–µ—Å—É—Ä—Å–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏ (fuel, memory), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ö–æ—Å—Ç‚Äë—Ñ—É–Ω–∫—Ü–∏—è–º–∏, —Ñ–∞–π–ª–æ–≤–æ–π –ø–µ—Å–æ—á–Ω–∏—Ü–µ–π; –≤–≤–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –ø–ª–∞–≥–∏–Ω–æ–≤.

3) –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç in‚Äëmemory BM25, Tantivy –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω (Medium)
- –°–∏–º–ø—Ç–æ–º: `SearchCoordinator` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `KeywordIndex::new()` –∏–∑ `keyword_index/mod.rs`, –∞ –Ω–µ `tantivy_index`.
- –†–∏—Å–∫: —Å–ª–∞–±–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å/–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≤–∫–ª—é—á–∏—Ç—å `tantivy` —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ —Ñ–ª–∞–≥—É/–∫–æ–Ω—Ñ–∏–≥—É, –æ–±–µ—Å–ø–µ—á–∏—Ç—å on‚Äëdisk –∏–Ω–¥–µ–∫—Å –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é.

4) –ü–æ–ª–∏—Ç–∏–∫–∞ ¬´Allow by default¬ª –≤–Ω–µ sandbox‚Äë—á–µ–∫–∞ (Medium)
- –°–∏–º–ø—Ç–æ–º: `PolicyEngine` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `Allow`, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–æ –Ω–µ —Å–æ–≤–ø–∞–ª–æ. –î–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ FS/WEB –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–æ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö/–ø–ª–∞–≥–∏–Ω–æ–≤ ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `permissions`.
- –†–∏—Å–∫: ¬´—Ç–∏—Ö–æ–µ¬ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤/—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –±–µ–∑ —è–≤–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–º–µ–Ω–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç –Ω–∞ `Ask` (–∏–ª–∏ `Deny` –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∏—Å–∫–∞), –¥–æ–±–∞–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ guard‚Äë–ø—Ä–∞–≤–∏–ª–∞.

5) `shell_exec` –Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω –ø—Ä–∏ —è–≤–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ (High)
- –°–∏–º–ø—Ç–æ–º: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–∏—Ç–∏–∫–æ–π; –ø—Ä–∏ —Å–Ω—è—Ç–∏–∏ –±–ª–æ–∫–∞ –Ω–µ—Ç FS/NET root‚Äë–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç–∞—è env –∏ —Ç–∞–π–º–∞—É—Ç. –ù–µ—Ç deny‚Äë—Å–ø–∏—Å–∫–∞/–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–≤–Ω–µ —Ç–µ—Å—Ç–æ–≤/–≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤ —Ä–µ–µ—Å—Ç—Ä–∞).
- –†–∏—Å–∫: –æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏ –æ—à–∏–±–æ—á–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–µ.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (allow‚Äë—Å–ø–∏—Å–æ–∫ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ –∫–æ–º–∞–Ω–¥, chroot/namespace –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä), –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π dry‚Äërun+ask.

6) EventBus: ¬´publish_timeout¬ª –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω (Low/Design)
- –°–∏–º–ø—Ç–æ–º: `timeout` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `broadcast::Sender::send` –≤–Ω—É—Ç—Ä–∏ async‚Äë–±–ª–æ–∫–∞ ‚Äî —Ç–∞–π–º–∞—É—Ç –Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∞ (–æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ await'–∏—Ç—Å—è).
- –†–∏—Å–∫: –≤–≤–æ–¥–∏—Ç –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ, –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —É–±—Ä–∞—Ç—å ¬´—Ç–∞–π–º–∞—É—Ç¬ª, –æ—Å—Ç–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ `Lagged/No subscribers`.

7) –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–∞–º—è—Ç–∏ ‚Äî JSONL –≤–º–µ—Å—Ç–æ SQLite (Medium)
- –°–∏–º–ø—Ç–æ–º: `SimpleMemoryEngine` –ø–∏—à–µ—Ç –≤ `magray_memory.jsonl`, –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π/–∏–Ω–¥–µ–∫—Å–æ–≤.
- –†–∏—Å–∫: –ø–æ—Ç–µ—Ä—è/–¥—É–±–ª–∏ –ø—Ä–∏ —Å–±–æ—è—Ö, —Å–ª–∞–±–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, –Ω–µ—Ç ACID.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≤–≤–µ—Å—Ç–∏ SQLite —Å–ª–æ–π (–∏–ª–∏ sled —Å –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º) + –º–∏–≥—Ä–∞—Ü–∏–∏.

8) –ü–ª–∞–≥–∏–Ω—ã: –Ω–µ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏/–ø–æ–¥–ø–∏—Å–∏/–ø–æ–ª–∏—Ç–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (High)
- –°–∏–º–ø—Ç–æ–º: `tools/plugins` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∏, –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Ö—ç—à–∏, –Ω–µ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
- –†–∏—Å–∫: —Ü–µ–ø–æ—á–∫–∞ –ø–æ—Å—Ç–∞–≤–∫–∏.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–æ–¥–ø–∏—Å–∏ (Ed25519), —Ö—ç—à‚Äë–ø–∏–Ω—ã, –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö.

9) –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–∫–∞–Ω–µ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤/PII –ø—Ä–∏ –≤—ã–≤–æ–¥–µ/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ (Medium)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ FS/Git –∏ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ —Å–µ—Ç—å ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ (–∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã) –∏ —Ä–µ–¥–∞–∫—Ü–∏—è.

10) –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CLI —Ä–∞—Å—Ö–æ–¥–∏—Ç—Å—è —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π (Low)
- –°–∏–º–ø—Ç–æ–º: `docs/API.md` —É–∫–∞–∑—ã–≤–∞–µ—Ç `magray tool`, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ `magray tools`.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≤—ã—Ä–æ–≤–Ω—è—Ç—å –¥–æ–∫–∏/CLI.

11) –î—É–±–ª–∏ —Å–∏—Å—Ç–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (Medium)
- –°–∏–º–ø—Ç–æ–º: –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ `execution_pipeline` (legacy) –∏ `execution/pipeline` (v2), –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.
- –†–∏—Å–∫: —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥, —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤ –µ–¥–∏–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.

12) –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –ø–ª–∞–Ω–∞ (Medium/roadmap)
- Scheduler, Critic/Reflector, Policy DSL –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π, TUI –ø–∞–Ω–µ–ª–∏, KG, —Ä–µ—Ü–µ–ø—Ç—ã/flows DSL.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P0 (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å)
- MCP: –≤–≤–µ—Å—Ç–∏ allowlist —Å–µ—Ä–≤–µ—Ä–æ–≤/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –º–∞–ø–ø–∏–Ω–≥ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, –¥–µ—Ñ–æ–ª—Ç `Ask`, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
- WASM: –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ wasmtime+WASI; –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MVP ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ .wasm, sandbox FS, –ª–∏–º–∏—Ç—ã, —è–≤–Ω—ã–µ host‚Äë—Ñ—É–Ω–∫—Ü–∏–∏.
- –ü–æ–ª–∏—Ç–∏–∫–∞: –¥–µ—Ñ–æ–ª—Ç `Ask` –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤; –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π dry‚Äërun –ø—Ä–µ–≤—å—é –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–±–æ—á–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏.
- `shell_exec`: –æ—Å—Ç–∞–≤–∏—Ç—å Deny –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é; –ø—Ä–∏ Allow ‚Äî –∂—ë—Å—Ç–∫–∏–µ –ª–∏–º–∏—Ç—ã (cwd –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ, deny‚Äëpatterns, no network namespaces/rlimits).

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P1 (–∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞/–ø–∞–º—è—Ç–∏)
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å `tantivy` BM25 –ø–æ —Ñ–∏—á–µ `keyword-search` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é; on‚Äëdisk –∏–Ω–¥–µ–∫—Å.
- –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–∞–º—è—Ç—å –Ω–∞ SQLite (–∏–ª–∏ sled —Å –∂—É—Ä–Ω–∞–ª–æ–º) + –º–∏–≥—Ä–∞—Ü–∏–∏.
- –û—Ü–µ–Ω–∏—Ç—å rerank –∫–∞—á–µ—Å—Ç–≤–æ/–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∞ golden‚Äë–Ω–∞–±–æ—Ä–∞—Ö; –¥–æ–±–∞–≤–∏—Ç—å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (score‚Äëmerge) –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –º–æ–¥–µ–ª–∏.

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P2 (–Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å/UX/–∞—Ä—Ö)
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å EventBus publish ¬´—Ç–∞–π–º–∞—É—Ç¬ª.
- –í–∫–ª—é—á–∏—Ç—å JSON‚Äë–ª–æ–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ CI/production.
- –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å pipeline –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é CLI.

–ì—Ä—É–±–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç
- MCP hardening: 2‚Äì4 –¥–Ω—è.
- WASM (–º–∏–Ω–∏–º—É–º wasmtime + sandbox): 5‚Äì10 –¥–Ω–µ–π.
- Tantivy –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ¬´–∫–∞–∫ –ø–æ –ø–ª–∞–Ω—É¬ª: 2‚Äì3 –¥–Ω—è.
- SQLite —Å–ª–æ–π + –º–∏–≥—Ä–∞—Ü–∏–∏: 3‚Äì5 –¥–Ω–µ–π.
- –ü–æ–ª–∏—Ç–∏–∫–∏ `Ask` + –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø—Ä–µ–≤—å—é: 1‚Äì2 –¥–Ω—è.

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (—Ñ–∞–π–ª—ã/—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã)
- EventBus: `crates/common/src/event_bus.rs` (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `send` –≤–Ω—É—Ç—Ä–∏ `timeout`), `crates/common/src/events.rs` (–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫), `crates/common/src/topics.rs`.
- Policy: `crates/common/src/policy.rs` (default allow/deny shell_exec), –ø—Ä–µ–¥—á–µ–∫ `precheck_permissions`.
- Tools/CLI: `crates/cli/src/commands/tools.rs` (evaluate_tool + preview/ask), MCP —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è `AddMcp`.
- MCP: `crates/tools/src/mcp.rs` (–Ω–µ—Ç permissions, stdio proxy).
- WASM: `crates/tools/src/plugins/wasm_plugin.rs` (—ç–º—É–ª—è—Ü–∏—è —Ä–∞–Ω—Ç–∞–π–º–∞).
- ExternalProcess: `crates/tools/src/plugins/external_process.rs` (–∏–∑–æ–ª—è—Ü–∏—è —É—Ä–æ–≤–Ω—è User, –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/—Å–µ–∫—ä—é—Ä–∏—Ç–∏ –ø–æ–ª–∏—Ç–∏–∫ –û–°).
- BM25: `crates/memory/src/keyword_index/mod.rs` (in‚Äëmemory), `keyword_index/tantivy_index.rs` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–µ).
- SearchCoordinator: `crates/memory/src/orchestration/search_coordinator.rs` (—Ç–∞–π–º–∞—É—Ç—ã 50‚Äì100ms, –º–µ—Ç—Ä–∏–∫–∏, lazy rerank init).
- Memory simple engine: `crates/memory/src/api.rs` (JSONL store).
- Shell: `crates/tools/src/shell_ops.rs` (env –æ—á–∏—Å—Ç–∫–∞, —Ç–∞–π–º–∞—É—Ç—ã, –Ω–æ –Ω–µ—Ç FS/NET –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª–µ–π –ø—Ä–∏ Allow).

## PREVIEW/DRY‚ÄëRUN (—á—Ç–æ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ)
- –≠—Ç–æ—Ç –∞—É–¥–∏—Ç ‚Äî read‚Äëonly. –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ (–∫—Ä–æ–º–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –æ—Ç—á—ë—Ç–∞).
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –ø–æ–º–µ—á–µ–Ω—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ P0/P1/P2; —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö PR —Å –¥–∏—Ñ—Ñ–∞–º–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏.

## –ü–†–û–í–ï–†–ö–ê (–∫–∞–∫ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å MCP: –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å MCP‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å —Å–µ—Ç–µ–≤—ã–º –≤—ã–∑–æ–≤–æ–º –ø—Ä–∏ –ø—É—Å—Ç–æ–º `MAGRAY_NET_ALLOW` ‚Äî –¥–æ–ª–∂–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è (–ø–æ—Å–ª–µ —Ñ–∏–∫—Å–∞).
- WASM: –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π wasm‚Äë–ø–ª–∞–≥–∏–Ω (hello world) ‚Äî –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ wasmtime —Å –ª–∏–º–∏—Ç–∞–º–∏.
- –ì–∏–±—Ä–∏–¥: –≤–∫–ª—é—á–∏—Ç—å `keyword-search`, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `tantivy` (–ª–æ–≥/–º–µ—Ç—Ä–∏–∫–∏), —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ/–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.
- –ü–æ–ª–∏—Ç–∏–∫–∏: –¥–ª—è `shell_exec` –≤ —Ä–µ–∂–∏–º–µ Allow ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ ask/dry‚Äërun —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç, –∞ –æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è.
- EventBus: —É–±—Ä–∞—Ç—å ¬´—Ç–∞–π–º–∞—É—Ç¬ª –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/–ª–∞–≥–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö.

## –û–¢–ß–Å–¢ –û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò
- ‚úÖ Completed: —ç—Ç–æ—Ç —Ñ–∞–π–ª `docs/critical_audit.md` –¥–æ–±–∞–≤–ª–µ–Ω; –∞—É–¥–∏—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã –∏ –¥–∞—ë—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞–Ω.
- üîß #INCOMPLETE: —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∏–∫—Å—ã –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å (—Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö PR). –û—Ü–µ–Ω–∫–∞: —Å–º. —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –≤—ã—à–µ.

## MINI‚ÄëADR
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–µ—Å—Ç–Ω—ã–π –∞—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–ª–∞–Ω–∞, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä—ã–≤—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–ª–∞–Ω –∑–∞–∫—Ä—ã—Ç–∏—è.
- –ö—Ä–∏—Ç–µ—Ä–∏–∏: –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (default‚Äëdeny/ask, sandbox), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ANN+BM25+rerank, –ø–ª–∞–≥–∏–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (WASM/External/MCP), –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å.
- –û—Ç–≤–µ—Ä–≥–Ω—É—Ç—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: ¬´–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–µ¬ª –ø—Ä–∞–≤–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–æ–≤–µ—Ä–∏—è –∏ —Ä–∞–Ω—Ç–∞–π–º–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ ‚Äî –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
- –ö–æ–º–ø—Ä–æ–º–∏—Å—Å—ã: —á–∞—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ MVP (emulated WASM, in‚Äëmemory BM25, JSONL store) —Ä–∞–¥–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏; —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –∞–ø–≥—Ä–µ–π–¥–∞ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º.

## –î–ê–õ–¨–®–ï
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å PR‚Äë—Å–µ—Ä–∏—é –ø–æ P0: MCP hardening, WASM –Ω–∞ wasmtime, –ø–æ–ª–∏—Ç–∏–∫–∞ `Ask`/preview –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è side‚Äëeffects.
- –í–∫–ª—é—á–∏—Ç—å `tantivy` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞/–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
- –ü—Ä–æ—Ä–∞–±–æ—Ç–∞—Ç—å SQLite —Å–ª–æ–π –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏ + –±—ç–∫–∞–ø—ã.
- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã (`docs/API.md`) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å CLI.
- –í–∫–ª—é—á–∏—Ç—å JSON‚Äë–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production‚Äë–ø—Ä–æ—Ñ–∏–ª–µ –∏ –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å pipeline –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.