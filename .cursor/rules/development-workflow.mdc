---
description: "Development Workflow: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è CLI-–∞–≥–µ–Ω—Ç–∞"
globs: ["**/*.rs", "**/*.md", "**/*.toml", "**/*.yml"]
alwaysApply: true
---

## Workflow –¥–ª—è Background Agents

### 1. –ê–Ω–∞–ª–∏–∑ –∑–∞–¥–∞—á–∏
```bash
# –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
bash scripts/agent-checklist.sh

# –ü—Ä–æ–≤–µ—Ä—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã
grep -A 5 "–ë–õ–û–ö–ï–†" implementation_plan/INCOMPLETE.md
```

### 2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Task Master Protocol)
- –°–æ–∑–¥–∞–π task file –≤ `docs/task_master/<task-id>.md`
- –û–ø—Ä–µ–¥–µ–ª–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: BLOCKER > CRITICAL > IMPORTANT > NICE2HAVE
- –ü–æ—Å—Ç—Ä–æ–π DAG —Å —É—á—ë—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –£–∫–∞–∂–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

### 3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
```rust
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ë–õ–û–ö–ï–†–´ (toolsvc, llm)
// - –ó–∞–º–µ–Ω–∏ –∑–∞–≥–ª—É—à–∫–∏ –Ω–∞ —Ä–∞–±–æ—á–∏–π –∫–æ–¥
// - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π —Å executor
// - –î–æ–±–∞–≤—å —Ç–µ—Å—Ç—ã

// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ö–†–ò–¢–ò–ß–ù–´–ï (memory, nlu)  
// - –†–µ–∞–ª–∏–∑—É–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
// - –î–æ–±–∞–≤—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
// - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π —Å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –í–ê–ñ–ù–´–ï (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
// - –î–æ–±–∞–≤—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
// - –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
// - –£–ª—É—á—à–∏ UX
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
```bash
# L1: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–≤—Å–µ–≥–¥–∞)
cargo fmt --all && cargo clippy --all-targets -- -D warnings && cargo test --all

# L2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
cargo nextest run && cargo tarpaulin --out Xml

# L3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
# cli init && cli todo add "test" && cli run "test task"
```

### 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å
- –û–±–Ω–æ–≤–∏ `implementation_plan/INCOMPLETE.md` (‚ùå ‚Üí ‚úÖ)
- –ó–∞–ø–∏—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ task file
- –û–±–Ω–æ–≤–∏ `docs/workflow_state.md`
- –ö–æ–º–º–∏—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º: `ü§ñ Background Agent: <component>/<feature>`

### 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –¥–µ–ø–ª–æ–π
```bash
# –°–æ–∑–¥–∞–π PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
git checkout -b bg/task-<id>/<component>
git commit -m "ü§ñ Background Agent: Implement <component>"
git push origin bg/task-<id>/<component>

# PR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç CI/CD
# –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤ main - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
```

## –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –¥–ª—è CLI-–∞–≥–µ–Ω—Ç–∞

### –†–∞–±–æ—Ç–∞ —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏
```bash
# –ù–∞–π–¥–∏ –≤—Å–µ –∑–∞–≥–ª—É—à–∫–∏ –≤ –∫–æ–¥–µ
grep -r "#INCOMPLETE\|TODO.*BLOCKER\|fake_content\|–∑–∞–≥–ª—É—à–∫–∞" --include="*.rs" .

# –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–π –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
# toolsvc > llm > memory > nlu > –æ—Å—Ç–∞–ª—å–Ω–æ–µ
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ memory —Å–ª–æ—ë–≤
```rust
#[test]
fn test_memory_integration() {
    // M0 (temp) ‚Üí M1 (kv) ‚Üí M2 (structured) ‚Üí M3 (blobs) ‚Üí M4 (semantic)
    let coordinator = MemoryCoordinator::new();
    
    // –°–æ—Ö—Ä–∞–Ω–∏ –¥–∞–Ω–Ω—ã–µ –≤ M0
    coordinator.store_ephemeral("key", value);
    
    // –ü—Ä–æ–≤–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–º–æ—É—à–µ–Ω
    thread::sleep(Duration::from_secs(1));
    assert!(coordinator.exists_in_layer("key", Layer::M1));
}
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```bash
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–π –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
echo "üìä Development Progress:"
echo "Blockers resolved: $(grep -c '‚úÖ.*–ë–õ–û–ö–ï–†' implementation_plan/INCOMPLETE.md)"
echo "Test coverage: $(cargo tarpaulin --print-summary | grep 'Coverage' | cut -d: -f2)"
echo "Code quality: $(cargo clippy --all-targets 2>&1 | grep -c 'warning\|error')"
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub Actions

### Issue ‚Üí Task –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- Issues —Å –ª–µ–π–±–ª–æ–º `background-agent` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç task files
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ/–æ–ø–∏—Å–∞–Ω–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ project board

### Scheduled –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤: –ø—Ä–æ–≤–µ—Ä–∫–∞ stale tasks
- –ù–æ—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏: –ø–æ–ª–Ω—ã–π agent-checklist
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ issues –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö

### Manual execution
- Workflow dispatch –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞—á
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤: blocker/critical/normal/low
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## Best Practices

1. **–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å –±–ª–æ–∫–µ—Ä–æ–≤** - –±–µ–∑ toolsvc –∏ llm –æ—Å—Ç–∞–ª—å–Ω–æ–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **–¢–µ—Å—Ç–∏—Ä—É–π –∫–∞–∂–¥—ã–π —à–∞–≥** - –æ—Å–æ–±–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏  
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –ø—Ä–æ–≥—Ä–µ—Å—Å** - –æ–±–Ω–æ–≤–ª—è–π INCOMPLETE.md –∏ task files
4. **–ò—Å–ø–æ–ª—å–∑—É–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–∏—Ç—ã** - `ü§ñ Background Agent: <action>`
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å –∫–∞—á–µ—Å—Ç–≤–æ** - –ø–æ–∫—Ä—ã—Ç–∏–µ ‚â•80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π
6. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π —Ä—É—Ç–∏–Ω—É** - –∏—Å–ø–æ–ª—å–∑—É–π GitHub Actions –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–¥–∞—á